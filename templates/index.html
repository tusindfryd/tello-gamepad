<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <style>
        body {
            display: flex;
            justify-content: center;
        }
    </style>
    <script src="../static/gamecontroller.min.js"></script>
    <script>
        let buttonEvent = (button) => {
            fetch(`/getdata/${button}`)
                .then((response) => {
                    return response.text();
                })
        }
        gameControl.on('connect', function (gamepad) {
            // d-pad
            gamepad.after('button12', () => {
                buttonEvent("button up")
            });
            gamepad.after('button13', () => {
                buttonEvent("button down")
            });
            gamepad.after('button14', () => {
                buttonEvent("button left")
            });
            gamepad.after('button15', () => {
                buttonEvent("button right")
            });

            // action buttons
            gamepad.after('button0', () => {
                buttonEvent("A")
            });
            gamepad.after('button1', () => {
                buttonEvent("B")
            });
            gamepad.after('button2', () => {
                buttonEvent("X")
            });
            gamepad.after('button3', () => {
                buttonEvent("Y")
            });

            // shoulder buttons
            gamepad.on('button4', () => {
                buttonEvent("LB")
            });
            gamepad.on('button5', () => {
                buttonEvent("RB")
            });
            gamepad.on('button6', () => {
                buttonEvent("LT")
            });
            gamepad.on('button7', () => {
                buttonEvent("RT")
            });

            // left stick
            gamepad.on('up0', () => {
                buttonEvent("left stick up")
            });
            gamepad.on('down0', () => {
                buttonEvent("left stick down")
            });
            gamepad.on('right0', () => {
                buttonEvent("left stick right")
            });
            gamepad.on('left0', () => {
                buttonEvent("left stick left")
            });

            // right stick
            gamepad.on('up1', () => {
                buttonEvent("right stick up")
            });
            gamepad.on('down1', () => {
                buttonEvent("right stick down")
            });
            gamepad.on('right1', () => {
                buttonEvent("right stick right")
            });
            gamepad.on('left1', () => {
                buttonEvent("right stick left")
            });
        });
    </script>
</head>

<body>
    <main>
        <img src="/stream">
    </main>
</body>

</html>